# 项目交接文档 - VKMath Kids 数学学习游戏

## 项目概述
这是一个为5岁儿童设计的数学学习游戏，采用塞尔达风格的RPG战斗系统。用户有两个孩子：
- **Abby（妹妹）**：只会个位数加法，需要学习进位加法
- **Josh（哥哥）**：数学能力较强，可以学习乘除法

## 当前进度

### 已完成 ✅
1. **基础游戏框架**
   - Next.js 14 + TypeScript + Tailwind CSS
   - Prisma ORM with SQLite
   - 基本的战斗系统（答题正确攻击敌人）

2. **数据模型设计**
   - 完整的角色系统（等级、经验值、金币）
   - 装备系统（武器、护甲、盾牌）
   - 关卡系统（9个关卡，分5个区域）

3. **已创建的文件**
   - `/prisma/schema.prisma` - 新的数据库模型
   - `/types/game.ts` - 游戏类型定义
   - `/data/equipment.ts` - 装备数据（三个等级的武器、护甲、盾牌）
   - `/data/stages.ts` - 关卡数据（森林、山脉、火山、地下城、魔界）
   - `/app/hub/page.tsx` - 关卡选择界面

### 正在进行 🔄
1. **重构游戏页面** (`/app/game/page.tsx`)
   - 需要整合新的Character和Stage系统
   - 实现经验值和等级提升
   - 支持从hub页面选择的关卡

### 待完成 📋
1. **商店系统** (`/app/store/page.tsx`)
   - 展示可购买的装备
   - 根据等级和金币筛选
   - 购买并装备到角色

2. **装备界面** (`/app/equipment/page.tsx`)
   - 显示当前装备
   - 装备管理（穿戴/卸下）
   - 属性对比

3. **数据持久化**
   - 实现真实的数据库操作
   - 保存角色进度
   - 装备和购买记录

4. **游戏机制完善**
   - 经验值计算和升级
   - 装备对属性的影响
   - 关卡解锁机制

## 关键设计决策

### 1. 游戏流程
```
选择角色 → 进入Hub → 选择关卡 → 战斗（答题） → 获得经验和金币 → 商店购买装备 → 提升实力 → 挑战更难关卡
```

### 2. 经验值和等级系统
- 每个敌人有expDrop（经验值奖励）
- 升级公式：`100 * level * Math.floor(level / 2 + 1)`
- 升级提升基础属性

### 3. 装备系统
- 5个等级的装备（Tier 1-5）
- 装备需要等级限制
- 提供生命值、攻击力、防御力加成

### 4. 用户需求重点
- **商业级品质**：不要简单丑陋的游戏
- **进度系统**：像《炎龙骑士团》那样的成长系统
- **视觉效果**：用户提供了DALL-E 3 API，可生成专业图片资源

## API密钥（用于生成图片）
```
API Key: sk-GLjZRbocrDPzRiNJOXL5E3SnWEF7DjfqYIVR9aioZkLMmjHe
Model: dall-e-3
```

## 下一步建议

1. **先完成游戏页面重构**
   - 整合Stage系统
   - 实现经验值和升级
   - 支持多个敌人的关卡

2. **创建商店页面**
   - 使用`/data/equipment.ts`的数据
   - 实现购买逻辑
   - 美观的UI设计

3. **实现装备系统**
   - 创建装备管理界面
   - 实现装备对属性的影响
   - 在战斗中体现装备效果

4. **美化UI**
   - 使用DALL-E 3生成角色立绘
   - 生成装备图标
   - 创建精美的背景图

5. **添加音效和动画**
   - 升级特效
   - 装备获得动画
   - 背景音乐

## 技术栈
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- Prisma ORM + SQLite
- Framer Motion
- Railway部署平台

## 本地启动
```bash
./start.sh
# 或
npm run dev
```

## 注意事项
1. 用户强调要**商业级品质**，不要简单的实现
2. 游戏主要在iPad上使用，需要触屏优化
3. Abby只学加减法，Josh可以学所有运算
4. 最终要部署到Railway平台

祝你顺利完成这个项目！记得保持高品质的视觉效果和流畅的游戏体验。